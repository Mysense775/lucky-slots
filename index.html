<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>üé∞ NEON SLOTS</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;800&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-pink: #ff006e;
            --neon-blue: #00f5ff;
            --neon-purple: #8338ec;
            --neon-gold: #ffd700;
            --dark-bg: #0a0a0f;
            --glass: rgba(255, 255, 255, 0.03);
            --glass-border: rgba(255, 255, 255, 0.08);
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--dark-bg);
            min-height: 100vh;
            min-height: 100dvh;
            overflow-x: hidden;
            position: relative;
            color: white;
        }
        
        /* Animated mesh gradient background */
        .bg-mesh {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            z-index: 0;
            background: 
                radial-gradient(ellipse at 20% 20%, rgba(255, 0, 110, 0.15) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(0, 245, 255, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(131, 56, 236, 0.08) 0%, transparent 70%);
            animation: meshMove 20s ease-in-out infinite;
        }
        
        @keyframes meshMove {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(30px, -30px) scale(1.1); }
            66% { transform: translate(-20px, 20px) scale(0.95); }
        }
        
        /* Floating orbs */
        .orb {
            position: fixed;
            border-radius: 50%;
            filter: blur(80px);
            opacity: 0.4;
            z-index: 0;
        }
        
        .orb-1 { width: 400px; height: 400px; background: var(--neon-pink); top: -10%; left: -10%; animation: float 15s ease-in-out infinite; }
        .orb-2 { width: 300px; height: 300px; background: var(--neon-blue); bottom: -5%; right: -10%; animation: float 12s ease-in-out infinite reverse; }
        .orb-3 { width: 200px; height: 200px; background: var(--neon-purple); top: 50%; left: 50%; animation: float 18s ease-in-out infinite; }
        
        @keyframes float {
            0%, 100% { transform: translate(0, 0); }
            50% { transform: translate(50px, -30px); }
        }
        
        /* Particles */
        .particles-container {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .particle {
            position: absolute;
            width: 4px; height: 4px;
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-blue));
            border-radius: 50%;
            opacity: 0;
            animation: particleFloat 10s ease-in-out infinite;
            box-shadow: 0 0 10px currentColor;
        }
        
        @keyframes particleFloat {
            0% { 
                opacity: 0;
                transform: translateY(100vh) scale(0) rotate(0deg);
            }
            10% { opacity: 0.8; }
            90% { opacity: 0.8; }
            100% { 
                opacity: 0;
                transform: translateY(-20vh) scale(1.5) rotate(720deg);
            }
        }
        
        /* Shooting stars */
        .shooting-stars {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .shooting-star {
            position: absolute;
            width: 100px; height: 2px;
            background: linear-gradient(90deg, transparent, white, transparent);
            opacity: 0;
            animation: shoot 4s ease-out infinite;
            filter: drop-shadow(0 0 6px white);
        }
        
        .shooting-star:nth-child(1) {
            top: 20%; left: -100px;
            animation-delay: 0s;
            transform: rotate(-45deg);
        }
        
        .shooting-star:nth-child(2) {
            top: 40%; left: -100px;
            animation-delay: 2s;
            transform: rotate(-40deg);
        }
        
        .shooting-star:nth-child(3) {
            top: 60%; left: -100px;
            animation-delay: 1s;
            transform: rotate(-50deg);
        }
        
        @keyframes shoot {
            0% { 
                opacity: 0;
                transform: translateX(0) rotate(-45deg);
            }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { 
                opacity: 0;
                transform: translateX(calc(100vw + 200px)) rotate(-45deg);
            }
        }
        
        /* Grid overlay */
        .grid-overlay {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            background-image: 
                linear-gradient(rgba(255,255,255,0.02) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.02) 1px, transparent 1px);
            background-size: 50px 50px;
            pointer-events: none;
            z-index: 1;
            animation: gridPulse 4s ease-in-out infinite;
        }
        
        @keyframes gridPulse {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }
        
        /* Floating shapes */
        .floating-shapes {
            position: fixed;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }
        
        .shape {
            position: absolute;
            opacity: 0.1;
            animation: shapeFloat 20s ease-in-out infinite;
        }
        
        .shape.diamond {
            width: 30px; height: 30px;
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
            transform: rotate(45deg);
        }
        
        .shape.circle {
            width: 40px; height: 40px;
            border: 2px solid var(--neon-blue);
            border-radius: 50%;
            background: transparent;
        }
        
        .shape:nth-child(1) { top: 10%; left: 10%; animation-delay: 0s; }
        .shape:nth-child(2) { top: 70%; left: 80%; animation-delay: 5s; }
        .shape:nth-child(3) { top: 30%; left: 85%; animation-delay: 10s; }
        .shape:nth-child(4) { top: 80%; left: 15%; animation-delay: 3s; }
        .shape:nth-child(5) { top: 50%; left: 5%; animation-delay: 7s; }
        
        @keyframes shapeFloat {
            0%, 100% { 
                transform: translate(0, 0) rotate(0deg);
                opacity: 0.1;
            }
            25% { 
                transform: translate(30px, -30px) rotate(90deg);
                opacity: 0.2;
            }
            50% { 
                transform: translate(0, -60px) rotate(180deg);
                opacity: 0.1;
            }
            75% { 
                transform: translate(-30px, -30px) rotate(270deg);
                opacity: 0.2;
            }
        }
        
        /* Noise texture overlay */
        .noise {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            opacity: 0.03;
            z-index: 1;
            pointer-events: none;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 256 256' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
        }
        
        /* Main container */
        #app {
            position: relative;
            z-index: 2;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            padding: env(safe-area-inset-top) 20px env(safe-area-inset-bottom);
        }
        
        /* Header */
        .header {
            text-align: center;
            padding: 30px 0 20px;
        }
        
        .logo {
            font-family: 'Space Grotesk', sans-serif;
            font-size: clamp(32px, 8vw, 48px);
            font-weight: 700;
            letter-spacing: -2px;
            background: linear-gradient(135deg, #fff 0%, #a0a0a0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
        }
        
        .logo::after {
            content: 'NEON SLOTS';
            position: absolute;
            top: 0; left: 0;
            background: linear-gradient(90deg, var(--neon-pink), var(--neon-blue), var(--neon-purple), var(--neon-pink));
            background-size: 300% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            animation: gradientFlow 4s linear infinite;
            opacity: 0;
            transition: opacity 0.5s;
        }
        
        .logo:hover::after { opacity: 1; }
        
        @keyframes gradientFlow {
            0% { background-position: 0% 50%; }
            100% { background-position: 300% 50%; }
        }
        
        .subtitle {
            font-size: 11px;
            letter-spacing: 4px;
            text-transform: uppercase;
            color: rgba(255,255,255,0.4);
            margin-top: 5px;
        }
        
        /* Balance card */
        .balance-card {
            background: var(--glass);
            backdrop-filter: blur(20px) saturate(180%);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            padding: 20px 28px;
            margin: 0 auto 25px;
            display: flex;
            align-items: center;
            gap: 16px;
            max-width: 320px;
            box-shadow: 
                0 8px 32px rgba(0,0,0,0.3),
                inset 0 1px 0 rgba(255,255,255,0.05);
            position: relative;
            overflow: hidden;
        }
        
        .balance-card::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
        }
        
        .balance-icon {
            width: 52px; height: 52px;
            background: linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,215,0,0.05));
            border: 1px solid rgba(255,215,0,0.3);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 26px;
            box-shadow: 0 8px 32px rgba(255,215,0,0.2);
        }
        
        .balance-info { flex: 1; }
        
        .balance-label {
            font-size: 11px;
            color: rgba(255,255,255,0.5);
            text-transform: uppercase;
            letter-spacing: 1.5px;
            margin-bottom: 2px;
        }
        
        .balance-value {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--neon-gold), #ffaa00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* Slot machine container */
        .slot-container {
            background: var(--glass);
            backdrop-filter: blur(30px) saturate(180%);
            border: 1px solid var(--glass-border);
            border-radius: 32px;
            padding: 28px;
            margin: 0 auto;
            max-width: 380px;
            box-shadow: 
                0 25px 80px rgba(0,0,0,0.4),
                inset 0 1px 0 rgba(255,255,255,0.08);
            position: relative;
        }
        
        .slot-container::before {
            content: '';
            position: absolute;
            inset: -1px;
            border-radius: 33px;
            padding: 1px;
            background: linear-gradient(135deg, rgba(255,0,110,0.5), rgba(0,245,255,0.5), rgba(131,56,236,0.5));
            -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
            -webkit-mask-composite: xor;
            mask-composite: exclude;
            opacity: 0.5;
        }
        
        /* Reels frame */
        .reels-frame {
            background: linear-gradient(180deg, rgba(0,0,0,0.4), rgba(0,0,0,0.2));
            border-radius: 20px;
            padding: 20px;
            display: flex;
            gap: 12px;
            justify-content: center;
            box-shadow: inset 0 4px 20px rgba(0,0,0,0.5);
            position: relative;
        }
        
        /* Reel styling */
        .reel {
            width: 90px;
            height: 110px;
            background: linear-gradient(180deg, #0f0f15 0%, #1a1a25 100%);
            border-radius: 16px;
            overflow: hidden;
            position: relative;
            box-shadow: 
                0 8px 32px rgba(0,0,0,0.4),
                inset 0 2px 4px rgba(255,255,255,0.05);
            border: 1px solid rgba(255,255,255,0.06);
        }
        
        .reel::before, .reel::after {
            content: '';
            position: absolute;
            left: 0; right: 0;
            height: 35%;
            z-index: 10;
            pointer-events: none;
        }
        
        .reel::before {
            top: 0;
            background: linear-gradient(180deg, rgba(10,10,15,0.9), transparent);
        }
        
        .reel::after {
            bottom: 0;
            background: linear-gradient(0deg, rgba(10,10,15,0.9), transparent);
        }
        
        .reel-content {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 52px;
            transition: transform 0.05s linear;
            will-change: transform;
        }
        
        .reel.spinning .reel-content {
            animation: reelBlur 0.08s linear infinite;
            filter: blur(2px);
        }
        
        @keyframes reelBlur {
            0% { transform: translateY(-100%) scaleY(1.1); }
            100% { transform: translateY(100%) scaleY(1.1); }
        }
        
        /* Win line glow */
        .win-line {
            position: absolute;
            top: 50%; left: 10px; right: 10px;
            height: 3px;
            background: linear-gradient(90deg, transparent, var(--neon-gold), transparent);
            transform: translateY(-50%);
            opacity: 0;
            transition: opacity 0.3s;
            border-radius: 2px;
        }
        
        .win-line.active {
            opacity: 1;
            animation: winGlow 0.6s ease-in-out infinite alternate;
            box-shadow: 0 0 20px var(--neon-gold), 0 0 40px var(--neon-gold);
        }
        
        @keyframes winGlow {
            from { opacity: 0.6; }
            to { opacity: 1; }
        }
        
        /* Bet selector */
        .bet-section {
            margin-top: 24px;
        }
        
        .bet-label {
            font-size: 11px;
            color: rgba(255,255,255,0.4);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 12px;
            text-align: center;
        }
        
        .bet-chips {
            display: flex;
            gap: 8px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .bet-chip {
            min-width: 64px;
            padding: 12px 16px;
            background: rgba(255,255,255,0.03);
            border: 1px solid rgba(255,255,255,0.08);
            border-radius: 14px;
            color: rgba(255,255,255,0.7);
            font-family: 'Space Grotesk', sans-serif;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .bet-chip:hover:not(:disabled) {
            background: rgba(255,255,255,0.08);
            border-color: rgba(255,255,255,0.15);
            transform: translateY(-2px);
        }
        
        .bet-chip.active {
            background: linear-gradient(135deg, rgba(255,0,110,0.3), rgba(131,56,236,0.3));
            border-color: rgba(255,0,110,0.5);
            color: white;
            box-shadow: 0 4px 20px rgba(255,0,110,0.3);
        }
        
        /* Spin button */
        .spin-btn {
            width: 100%;
            margin-top: 20px;
            padding: 20px;
            background: linear-gradient(135deg, var(--neon-pink), var(--neon-purple));
            background-size: 200% 200%;
            border: none;
            border-radius: 18px;
            color: white;
            font-family: 'Space Grotesk', sans-serif;
            font-size: 18px;
            font-weight: 700;
            letter-spacing: 3px;
            text-transform: uppercase;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 40px rgba(255,0,110,0.4);
        }
        
        .spin-btn::before {
            content: '';
            position: absolute;
            top: 0; left: -100%;
            width: 100%; height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.5s;
        }
        
        .spin-btn:hover:not(:disabled)::before {
            left: 100%;
        }
        
        .spin-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 15px 50px rgba(255,0,110,0.5);
            animation: gradientShift 3s ease infinite;
        }
        
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        
        .spin-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
        
        .spin-btn.spinning {
            animation: spinPulse 0.6s ease-in-out infinite;
        }
        
        @keyframes spinPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(0.98); }
        }
        
        /* Win display */
        .win-display {
            margin-top: 20px;
            min-height: 70px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .win-amount {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 42px;
            font-weight: 700;
            background: linear-gradient(135deg, var(--neon-gold), #ffaa00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 30px rgba(255,215,0,0.3);
            animation: winPop 0.5s cubic-bezier(0.68, -0.55, 0.265, 1.55);
        }
        
        @keyframes winPop {
            0% { transform: scale(0) rotate(-10deg); opacity: 0; }
            70% { transform: scale(1.1) rotate(2deg); }
            100% { transform: scale(1) rotate(0); opacity: 1; }
        }
        
        .win-label {
            font-size: 11px;
            color: rgba(255,255,255,0.5);
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 4px;
        }
        
        /* Paytable */
        .paytable {
            margin-top: auto;
            padding: 24px 0 30px;
        }
        
        .paytable-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 16px;
            padding: 0 4px;
        }
        
        .paytable-line {
            flex: 1;
            height: 1px;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        }
        
        .paytable-title {
            font-size: 10px;
            color: rgba(255,255,255,0.4);
            text-transform: uppercase;
            letter-spacing: 3px;
        }
        
        .paytable-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 8px;
        }
        
        .pay-item {
            background: var(--glass);
            border: 1px solid var(--glass-border);
            border-radius: 12px;
            padding: 12px 8px;
            text-align: center;
            transition: all 0.2s;
        }
        
        .pay-item:hover {
            background: rgba(255,255,255,0.06);
            transform: translateY(-2px);
        }
        
        .pay-emoji {
            font-size: 24px;
            margin-bottom: 4px;
        }
        
        .pay-multiplier {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 12px;
            font-weight: 700;
            color: var(--neon-gold);
        }
        
        /* Responsive */
        @media (max-width: 380px) {
            .reel { width: 75px; height: 95px; }
            .reel-content { font-size: 44px; }
            .bet-chip { min-width: 56px; padding: 10px 12px; font-size: 13px; }
        }
        
        /* Safe area for iPhone */
        @supports (padding-top: env(safe-area-inset-top)) {
            #app { padding-top: max(20px, env(safe-area-inset-top)); }
        }
    </style>
</head>
<body>
    <div class="bg-mesh"></div>
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
    <div class="orb orb-3"></div>
    <div class="noise"></div>
    
    <!-- Animated particles -->
    <div class="particles-container" id="particles"></div>
    
    <!-- Shooting stars -->
    <div class="shooting-stars">
        <div class="shooting-star"></div>
        <div class="shooting-star"></div>
        <div class="shooting-star"></div>
    </div>
    
    <!-- Grid overlay -->
    <div class="grid-overlay"></div>
    
    <!-- Floating diamonds -->
    <div class="floating-shapes">
        <div class="shape diamond"></div>
        <div class="shape diamond"></div>
        <div class="shape diamond"></div>
        <div class="shape circle"></div>
        <div class="shape circle"></div>
    </div>
    
    <div id="app">
        <header class="header">
            <h1 class="logo">üé∞ NEON SLOTS</h1>
            <p class="subtitle">Ultimate Casino Experience</p>
        </header>
        
        <div class="balance-card">
            <div class="balance-icon">üíé</div>
            <div class="balance-info">
                <div class="balance-label">Your Balance</div>
                <div class="balance-value" id="balance">1,000</div>
            </div>
        </div>
        
        <div class="slot-container">
            <div class="reels-frame">
                <div class="reel" id="reel1">
                    <div class="reel-content">7Ô∏è‚É£</div>
                    <div class="win-line" id="winLine1"></div>
                </div>
                <div class="reel" id="reel2">
                    <div class="reel-content">üíé</div>
                    <div class="win-line" id="winLine2"></div>
                </div>
                <div class="reel" id="reel3">
                    <div class="reel-content">üîî</div>
                    <div class="win-line" id="winLine3"></div>
                </div>
            </div>
            
            <div class="bet-section">
                <div class="bet-label">Select Bet</div>
                <div class="bet-chips">
                    <button class="bet-chip active" data-bet="10" onclick="setBet(10)">10</button>
                    <button class="bet-chip" data-bet="50" onclick="setBet(50)">50</button>
                    <button class="bet-chip" data-bet="100" onclick="setBet(100)">100</button>
                    <button class="bet-chip" data-bet="500" onclick="setBet(500)">500</button>
                </div>
            </div>
            
            <button class="spin-btn" id="spinBtn" onclick="spin()">
                üé∞ SPIN üé∞
            </button>
            
            <div class="win-display" id="winDisplay"></div>
        </div>
        
        <div class="paytable">
            <div class="paytable-header">
                <div class="paytable-line"></div>
                <span class="paytable-title">Payouts</span>
                <div class="paytable-line"></div>
            </div>
            <div class="paytable-grid">
                <div class="pay-item">
                    <div class="pay-emoji">7Ô∏è‚É£</div>
                    <div class="pay-multiplier">√ó50</div>
                </div>
                <div class="pay-item">
                    <div class="pay-emoji">üíé</div>
                    <div class="pay-multiplier">√ó20</div>
                </div>
                <div class="pay-item">
                    <div class="pay-emoji">üîî</div>
                    <div class="pay-multiplier">√ó15</div>
                </div>
                <div class="pay-item">
                    <div class="pay-emoji">üçí</div>
                    <div class="pay-multiplier">√ó10</div>
                </div>
                <div class="pay-item">
                    <div class="pay-emoji">üçã</div>
                    <div class="pay-multiplier">√ó8</div>
                </div>
                <div class="pay-item">
                    <div class="pay-emoji">üçä</div>
                    <div class="pay-multiplier">√ó5</div>
                </div>
                <div class="pay-item">
                    <div class="pay-emoji">üçá</div>
                    <div class="pay-multiplier">√ó4</div>
                </div>
                <div class="pay-item">
                    <div class="pay-emoji">‚≠ê</div>
                    <div class="pay-multiplier">√ó3</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Initialize Telegram WebApp
        if (window.Telegram?.WebApp) {
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
            window.Telegram.WebApp.enableClosingConfirmation();
        }
        
        // Generate particles
        const particlesContainer = document.getElementById('particles');
        const particleCount = 30;
        const colors = ['#ff006e', '#00f5ff', '#8338ec', '#ffd700'];
        
        for (let i = 0; i < particleCount; i++) {
            const p = document.createElement('div');
            p.className = 'particle';
            p.style.left = Math.random() * 100 + '%';
            p.style.animationDelay = Math.random() * 10 + 's';
            p.style.animationDuration = (8 + Math.random() * 6) + 's';
            p.style.background = `linear-gradient(135deg, ${colors[Math.floor(Math.random() * colors.length)]}, ${colors[Math.floor(Math.random() * colors.length)]})`;
            particlesContainer.appendChild(p);
        }
        
        // Game state
        let balance = 1000;
        let currentBet = 10;
        let isSpinning = false;
        
        // Symbols with weighted probabilities
        const symbols = [
            { emoji: '7Ô∏è‚É£', value: 50, weight: 2 },
            { emoji: 'üíé', value: 20, weight: 4 },
            { emoji: 'üîî', value: 15, weight: 6 },
            { emoji: 'üçí', value: 10, weight: 9 },
            { emoji: 'üçã', value: 8, weight: 12 },
            { emoji: 'üçä', value: 5, weight: 15 },
            { emoji: 'üçá', value: 4, weight: 18 },
            { emoji: '‚≠ê', value: 3, weight: 34 }
        ];
        
        function formatNumber(num) {
            return num.toLocaleString('en-US');
        }
        
        function getWeightedSymbol() {
            const totalWeight = symbols.reduce((sum, s) => sum + s.weight, 0);
            let random = Math.random() * totalWeight;
            for (const symbol of symbols) {
                random -= symbol.weight;
                if (random <= 0) return symbol;
            }
            return symbols[symbols.length - 1];
        }
        
        function setBet(amount) {
            if (isSpinning) return;
            currentBet = amount;
            document.querySelectorAll('.bet-chip').forEach(chip => {
                chip.classList.remove('active');
                if (parseInt(chip.dataset.bet) === amount) {
                    chip.classList.add('active');
                }
            });
        }
        
        function updateBalance() {
            document.getElementById('balance').textContent = formatNumber(balance);
        }
        
        function showWin(amount) {
            const display = document.getElementById('winDisplay');
            if (amount > 0) {
                display.innerHTML = `
                    <div class="win-label">YOU WON</div>
                    <div class="win-amount">+${formatNumber(amount)} üíé</div>
                `;
                setTimeout(() => display.innerHTML = '', 2500);
            } else {
                display.innerHTML = '';
            }
        }
        
        async function spin() {
            if (isSpinning || balance < currentBet) {
                if (balance < currentBet) {
                    if (window.Telegram?.WebApp) {
                        window.Telegram.WebApp.showAlert('üíé –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤!');
                    } else {
                        alert('üíé –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –∫—Ä–∏—Å—Ç–∞–ª–ª–æ–≤!');
                    }
                }
                return;
            }
            
            isSpinning = true;
            balance -= currentBet;
            updateBalance();
            
            const btn = document.getElementById('spinBtn');
            btn.disabled = true;
            btn.classList.add('spinning');
            btn.innerHTML = '<span class="spin-text">SPINNING...</span>';
            
            document.getElementById('winDisplay').innerHTML = '';
            document.querySelectorAll('.win-line').forEach(l => l.classList.remove('active'));
            
            const results = [];
            const spinDurations = [1200, 1800, 2400];
            
            for (let i = 0; i < 3; i++) {
                const reel = document.getElementById(`reel${i + 1}`);
                const content = reel.querySelector('.reel-content');
                reel.classList.add('spinning');
                
                let spinCount = 0;
                const spinInterval = setInterval(() => {
                    content.textContent = symbols[spinCount % symbols.length].emoji;
                    spinCount++;
                }, 80);
                
                await new Promise(resolve => {
                    setTimeout(() => {
                        clearInterval(spinInterval);
                        reel.classList.remove('spinning');
                        
                        const result = getWeightedSymbol();
                        results[i] = result;
                        content.textContent = result.emoji;
                        
                        resolve();
                    }, spinDurations[i]);
                });
            }
            
            checkWin(results);
        }
        
        function checkWin(results) {
            const [r1, r2, r3] = results;
            let winAmount = 0;
            let isBigWin = false;
            
            if (r1.emoji === r2.emoji && r2.emoji === r3.emoji) {
                winAmount = currentBet * r1.value;
                isBigWin = true;
                document.querySelectorAll('.win-line').forEach(l => l.classList.add('active'));
            } else if (r1.emoji === r2.emoji || r2.emoji === r3.emoji || r1.emoji === r3.emoji) {
                winAmount = currentBet * 2;
                document.querySelectorAll('.win-line').forEach(l => l.classList.add('active'));
            }
            
            if (winAmount > 0) {
                balance += winAmount;
                updateBalance();
                showWin(winAmount);
                
                if (window.Telegram?.WebApp && isBigWin) {
                    window.Telegram.WebApp.HapticFeedback.notificationOccurred('success');
                }
            } else {
                if (window.Telegram?.WebApp) {
                    window.Telegram.WebApp.HapticFeedback.notificationOccurred('error');
                }
            }
            
            setTimeout(() => {
                isSpinning = false;
                const btn = document.getElementById('spinBtn');
                btn.disabled = false;
                btn.classList.remove('spinning');
                btn.innerHTML = 'üé∞ SPIN üé∞';
            }, 500);
        }
        
        // Send data to bot on close
        window.addEventListener('beforeunload', () => {
            if (window.Telegram?.WebApp) {
                window.Telegram.WebApp.sendData(JSON.stringify({
                    action: 'game_end',
                    balance: balance
                }));
            }
        });
        
        // Initial balance display
        updateBalance();
    </script>
</body>
</html>